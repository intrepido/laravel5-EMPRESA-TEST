{"version":3,"sources":["users.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"users.js","sourcesContent":["$(document).ready(function () {\r\n\r\n        /*******************************\r\n         Para el UserController\r\n         *******************************/\r\n\r\n         cargarTable(1);\r\n\r\n        $(document).on('click', '.pagination a', function (e) { //Tiene que ser declarado con \"$(document).on\" para que asi pueda escuchar desde la raiz\r\n            e.preventDefault();                                  // del documento cualquier elemento dinamico que se cree, en este caso el componente\r\n            var page = $(this).attr('href').split('page=')[1];    // de paginacion. De ponerse asi \"$('.pagination a').on\" jamas se ejecutara.\r\n            cargarTable(page);\r\n        });\r\n\r\n        function cargarTable(page) {\r\n            $.ajax({\r\n                url: '/admin/user',\r\n                type: 'GET',\r\n                dataType: 'json',\r\n                data: {page: page},\r\n                success: function (data) {\r\n                    $(\"#tabla-user\").html(data);\r\n                },\r\n                error: function (msj) {\r\n                }\r\n            });\r\n        }\r\n\r\n        $(\"input[type=checkbox]\").attr('checked', false);\r\n\r\n        $('#collapseOne').on('hidden.bs.collapse', function () {\r\n            $('#direction').val('');\r\n            $('#expertise_area').val('');\r\n            $('#direction').removeAttr('required');\r\n            $('#expertise_area').removeAttr('required');\r\n        });\r\n\r\n        $('#collapseOne').on('shown.bs.collapse', function () {\r\n            $('#direction').attr('required', '');\r\n            $('#expertise_area').attr('required', '');\r\n        });\r\n\r\n        function cleanAll() {\r\n            $('#edit-state').hide();\r\n            $(\"input[type=checkbox]\").prop('checked', false);\r\n            $('#collapseOne').collapse('hide');\r\n            $('#name').val('');\r\n            $('#email').val('');\r\n            $('#password').val('');\r\n            $('#password_confirmation').val('');\r\n        }\r\n\r\n        /**************************************\r\n         UserController ---- Create and Update\r\n         *************************************/\r\n\r\n        $(\"input[type=checkbox]\").on(\"click\", function () {\r\n            $('#collapseOne').collapse('toggle');\r\n        });\r\n\r\n        $('#form-user-employee').on('submit', function (e) {\r\n            e.preventDefault();\r\n            var user = {\r\n                'name': $('#name').val(),\r\n                'email': $('#email').val(),\r\n                'password': $('#password').val(),\r\n                'password_confirmation': $('#password_confirmation').val(),\r\n                'direction': $('#direction').val(),\r\n                'expertise_area': $('#expertise_area').val()\r\n            };\r\n\r\n            var edit = $('#edit-state').is(':visible') ? true : false;\r\n\r\n            if (edit && !user.password) { //Asi garantizo que no me de error con el UserEmployeeUpdateRequest en caso de no pasar la contraseï¿½a. Esta no se puede pasar ni como null ni como '', sencillamante no se pasa\r\n                delete user.password;\r\n                delete user.password_confirmation;\r\n            }\r\n\r\n            var url = edit ? '/admin/user/' + $('#edit-state > span > span').text() : '/admin/user';\r\n            var type = edit ? 'PUT' : 'POST';\r\n            var pagination = edit ? $('.pagination .active > span').text() : 1;\r\n\r\n            $.ajax({\r\n                url: url,\r\n                headers: {'X-CSRF-TOKEN': $(\"input[name='_token']\").val()},\r\n                type: type,\r\n                dataType: 'json',\r\n                data: user,\r\n                success: function (msj) {\r\n                    cargarTable(pagination);\r\n                    $('#password').attr('required', '');\r\n                    $('#cancel').hide();\r\n                    $(\"#msj1\").empty();\r\n                    $(\"#msj1\").append(msj['message']);\r\n                    if (!$(\"#msj-success\").is(\":visible\")) {\r\n                        $(\"#msj-success\").fadeIn();\r\n                        $(\"#msj-success\").delay(2000).fadeOut(1000);\r\n                    }\r\n                    cleanAll();\r\n                },\r\n                error: function (msj) {\r\n                    $(\"#msj2\").empty();\r\n                    $.each(msj.responseJSON, function (key, value) {\r\n                        $(\"#msj2\").append('<li>' + value + '</li>');\r\n                    });\r\n                    if (!$(\"#msj-error\").is(\":visible\")) {\r\n                        $(\"#msj-error\").fadeIn();\r\n                        $(\"#msj-error\").delay(2000).fadeOut(1000);\r\n                    }\r\n                }\r\n            });\r\n        });\r\n\r\n        /*******************************\r\n         UserController ---- Delete\r\n         *******************************/\r\n\r\n        $(document).on('click', '.open-modal-delete', function () {\r\n            $('#delete-modal').modal('show');\r\n        });\r\n\r\n         $(document).on('click', '#delete-user', function () {\r\n            var id = $('.open-modal-delete').attr('id');\r\n\r\n            $.ajax({\r\n                url: '/admin/user/' + id,\r\n                headers: {'X-CSRF-TOKEN': $(\"input[name='_token']\").val()},\r\n                type: 'DELETE',\r\n                dataType: 'json',\r\n\r\n                success: function (msj) {\r\n                    cargarTable(1);\r\n                    $(\"#msj1\").empty();\r\n                    $(\"#msj1\").append(msj['message']);\r\n                    if (!$(\"#msj-success\").is(\":visible\")) {\r\n                        $(\"#msj-success\").fadeIn();\r\n                        $(\"#msj-success\").delay(2000).fadeOut(1000);\r\n                    }\r\n                },\r\n                error: function (msj) {\r\n                    $(\"#msj2\").empty();\r\n                    $.each(msj.responseJSON, function (key, value) {\r\n                        $(\"#msj2\").append('<li>' + value + '</li>');\r\n                    });\r\n                    if (!$(\"#msj-error\").is(\":visible\")) {\r\n                        $(\"#msj-error\").fadeIn();\r\n                        $(\"#msj-error\").delay(2000).fadeOut(1000);\r\n                    }\r\n                }\r\n            });\r\n\r\n            $('#delete-modal').modal('hide');\r\n        });\r\n\r\n        /*******************************\r\n         UserController ---- Edit\r\n         *******************************/\r\n\r\n        $(document).on('click', '.edit-user', function () {\r\n            var id = $(this).attr('id');\r\n\r\n            $.get('/admin/user/' + id + '/edit', function (data) {\r\n                //$('#name').val($(this).parents().eq(2).children().eq(0).text());\r\n                $('#name').val(data.user.name);\r\n                $('#email').val(data.user.email);\r\n                if (data.employee) {\r\n                    $(\"input[type=checkbox]\").prop('checked', true);\r\n                    $('#collapseOne').collapse('show');\r\n                    $('#direction').val(data.employee.direction);\r\n                    $('#expertise_area').val(data.employee.expertise_area);\r\n                } else {\r\n                    $(\"input[type=checkbox]\").prop('checked', false);\r\n                    $('#collapseOne').collapse('hide');\r\n                }\r\n                $('#edit-state').show();\r\n                $('#edit-state > span > span').text(data.user.id);\r\n                $('#cancel').show();\r\n                $('#password').removeAttr('required');\r\n            });\r\n        });\r\n\r\n        $('#cancel').on('click', function () {\r\n            cleanAll()\r\n            $(this).hide();\r\n        })\r\n\r\n    }\r\n)\r\n;"],"sourceRoot":"/source/"}